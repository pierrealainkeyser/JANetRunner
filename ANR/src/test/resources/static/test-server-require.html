<html lang="en">
<head>
<link rel="stylesheet/less" type="text/css" href="../../../main/resources/static/css/game.less" />
<link rel="stylesheet" type="text/css" href="../../../main/resources/static/css/icons.css" />

<link rel="stylesheet" type="text/css" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.3/animate.min.css" />

<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/less.js/2.4.0/less.js"></script>

<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.16/require.min.js"></script>

<style>
.element {
	position: absolute;
	width: 80;
	height: 111;
	background-color: blue;
}
</style>

<script type="text/javascript">
	require.config({
		baseUrl : "../../../main/resources/static/js/",
		paths : { jquery : "http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min",
			underscore : "http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.2/underscore-min",
			tweenlite : "http://cdnjs.cloudflare.com/ajax/libs/gsap/1.16.1/TweenMax.min" },//
		shim : {//
		tweenlite : { exports : 'TweenLite' } // 
		} //
	});

	require([ "jquery", "layout/package", "layout/impl/flowlayout", "anr/corpserver", "ui/jqueryboxsize", "ui/jquerytrackingbox",
			"layout/impl/translatelayout", "anr/card", "geometry/size" ],//
	function($, layout, FlowLayout, CorpServer, JQueryBoxSize, JQueryTrackingBox, TranslateLayout, Card, Size) {
		$(function() {
			var layoutManager = new layout.LayoutManager($("#main"));
			layoutManager.config.animDuration = 0.3;
			layoutManager.config.card = { normal : new Size(80, 111) };

			layoutManager.runLayout(function() {

				var h = layoutManager.container.height() - 5;

				//il faut rajouter une option pour replacer ans l'ordre sens
				var container = new layout.AbstractBoxContainer(layoutManager, {}, new FlowLayout({ direction : FlowLayout.Direction.RIGHT,
					align : FlowLayout.Align.LAST, spacing : 3, padding : 0 }));

				var flowlayout = new FlowLayout({});

				var archives = new CorpServer(layoutManager, { id : -1 });
				container.addChild(archives);

				var rd = new CorpServer(layoutManager, { id : -2 });
				container.addChild(rd);

				var hq = new CorpServer(layoutManager, { id : -3 });
				container.addChild(hq);
				container.addChild(new CorpServer(layoutManager, { id : -4 }));
				var remote2 = new CorpServer(layoutManager, { id : -5 });
				container.addChild(remote2);

				var c = new Card(layoutManager, { url : "01083.png", faction : "corp" });
				c.setFace(Card.FACE_DOWN);

				var c1 = new Card(layoutManager, { id:"debug",url : "01089.png", faction : "corp" });

				var c3 = new Card(layoutManager, { url : "01091.png", faction : "corp" });

				hq.upgrades.addChild(new JQueryBoxSize(layoutManager, $("<div class='element' style='background-color:red;'/>")))
				hq.upgrades.addChild(c3);
				hq.ices.addChild(c);
				hq.ices.addChild(c1);
				hq.ices.addChild(new Card(layoutManager, { url : "01088.png", faction : "corp" }));
				
				hq.mainContainer.cards.addChild(new Card(layoutManager, { url : "01080.png", faction : "corp" }));

				archives.mainContainer.cards.addChild(new Card(layoutManager, { url : "01082.png", faction : "corp" }));

				var trac = new JQueryTrackingBox(layoutManager, $("<div class='element' style='background-color:cyan;'/>"));
				trac.trackAbstractBox(hq.ices);

				var translateContainer = new layout.AbstractBoxContainer(layoutManager, {}, new TranslateLayout({ y : -1 }));
				translateContainer.local.moveTo({ x : 5, y : h });
				translateContainer.addChild(container);

				setTimeout(layoutManager.withinLayout(function() {
					rd.mainContainer.setCounter(15);

					rd.mainContainer.cards.addChild(c1);					
					remote2.mainContainer.cards.addChild(c3);
					remote2.mainContainer.cards.addChild(c);
				}), 1000);
			});
		});
	});
</script>


</head>
<div id="main"></div>
</html>