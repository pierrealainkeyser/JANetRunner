<html lang="en">
<head>

<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/animate.css/3.2.3/animate.min.css" />

<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.16.1/TweenMax.min.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.2/underscore-min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<script type="text/javascript" src="../../../main/resources/static/js/observable.js"></script>
<script type="text/javascript" src="../../../main/resources/static/js/geometry.js"></script>
<script type="text/javascript" src="../../../main/resources/static/js/layout2.js"></script>
<script type="text/javascript" src="../../../main/resources/static/js/ui-utils.js"></script>
<script type="text/javascript" src="../../../main/resources/static/js/flowlayout.js"></script>
<script type="text/javascript" src="../../../main/resources/static/js/anchorlayout.js"></script>
<script type="text/javascript" src="../../../main/resources/static/js/turntracker.js"></script>

<link rel="stylesheet" type="text/css" href="../../../main/resources/static/css/icons.css" />

<style>
.element {
	position: absolute;
}

.faction.score {
	position: absolute;
	width: 60px;
	height: 30px;
	display: table;
	border-radius: 3px;
	font-size: 20px;
	box-shadow: 0px 0px 1px 2px rgba(0, 0, 0, 0.35);
}

.faction.score .icon, .faction.score .scorearea {
	display: table-cell;
	width: 50%;
	height: 100%;
	vertical-align: middle;
	text-align: center;
}

.backbox {
	background-color: red;
}
</style>

<script type="text/javascript">
	function JQueryBackBox(layoutManager) {
		JQueryBox.call(this, layoutManager, $("<div class='element backbox'/>"), { zIndex : true, rotation : true, autoAlpha : true, size : true });
		AnimateAppeareanceCss.call(this, "rotateIn", "rotateOut");
	}
	var JQueryBackBoxMixin = function() {
		JQueryBoxMixin.call(this)
		TrackingScreenChangeBofLeafMixin.call(this, { zIndexDelta : -1 });
		AnimateAppeareanceCssMixin.call(this);

	}
	JQueryBackBoxMixin.call(JQueryBackBox.prototype);

	$(function() {
		var layoutManager = new LayoutManager($("#main"));
		layoutManager.config.animDuration = 0.3;

		layoutManager.runLayout(function() {
			var first = new AbstractBoxContainer(layoutManager, {}, flowLayout({ align : FlowLayout.Align.FIRST }));
			first.local.moveTo({ x : 200, y : 100 });
			var second = new AbstractBoxContainer(layoutManager, {}, flowLayout({ direction : FlowLayout.Direction.RIGHT }));
			var third = new AbstractBoxContainer(layoutManager, {}, flowLayout({ align : FlowLayout.Align.MIDDLE, direction : FlowLayout.Direction.TOP,
				padding : 10 }));

			var anchor = new AbstractBoxContainer(layoutManager, {}, anchorLayout({ minSize : new Size(200, 30), horizontal : AnchorLayout.Horizontal.MIDDLE,
				vertical : AnchorLayout.Vertical.BOTTOM }));
			anchor.addChild(new JQueryBox(layoutManager, $("<div class='element'>---</div>")))
			var backbox = new JQueryBackBox(layoutManager);

			var box = new JQueryBox(layoutManager, $("<div class='element'>PRE</div>"));
			first.addChild(box);
			first.addChild(second);

			first.addChild(new JQueryBox(layoutManager, $("<div class='element'>grand</div>")));
			first.addChild(new JQueryBox(layoutManager, $("<div class='element'>Troisième très très très grand</div>")));

			second.addChild(new JQueryBox(layoutManager, $("<div class='element'>+++</div>")));
			second.addChild(new JQueryBox(layoutManager, $("<div class='element'>___</div>")));
			second.addChild(new JQueryBox(layoutManager, $("<div class='element'>---</div>")));
			second.addChild(third);

			second.addChild(anchor)

			third.addChild(new JQueryBox(layoutManager, $("<div class='element'>11</div>")));
			third.addChild(new JQueryBox(layoutManager, $("<div class='element'>222</div>")));
			third.addChild(new JQueryBox(layoutManager, $("<div class='element'>333</div>")));
			third.addChild(new JQueryBox(layoutManager, $("<div class='element'>4444</div>")));

			backbox.trackAbstractBox(third);
			backbox.animateEnter(backbox.element);

			var scoreContainer = new AbstractBoxContainer(layoutManager, {}, flowLayout({ direction : FlowLayout.Direction.RIGHT, spacing : 10 }));
			scoreContainer.local.moveTo({ x : 400, y : 50 });

			var score = new ScoreFactionBox(layoutManager);
			score.setFaction("nbn");
			score.setScore(5);
			score.setActive(true);
			scoreContainer.addChild(score);

			var shaper = new ScoreFactionBox(layoutManager);
			shaper.setFaction("shaper");
			shaper.setScore(1);
			shaper.setActive(false);
			scoreContainer.addChild(shaper);

			setTimeout(layoutManager.withinLayout(function() {

				third.addChild(second)
				first.addChild(third);

				backbox.animateRemove(backbox.element);

				shaper.setScore(3);
				shaper.setActive(true);

			}), 1000);

		});

	});
</script>


</head>
<div id="main"></div>
</html>